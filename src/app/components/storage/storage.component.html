<!-- MODALS -->
<div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header py-1">
        <h5 class="modal-title m-0">Info about the selected {{selectedEntityType}}</h5>
        <button type="button" class="close " data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="" #i="ngForm" novalidate>

          <div class="form-group height-transition" *ngIf="formReady">

            <label form="nameInfo"> Name</label>
            <input disabled ngModel="{{selectedEntity.name}}" name="name" type="text" class="form-control mb-2"
                   id="nameInfo" placeholder="Name">

            <label form="sequenceInfo"> Sequence</label>
            <input disabled ngModel="{{selectedEntity.sequence.value}}" name="sequence" type="text" class="form-control"
                   id="sequenceInfo" placeholder="Sequence">


            <div *ngIf="selectedEntityType == 'enzyme'" class="mt-2">

              <div class="form-row align-items-center">

                <div class="col-6">
                  <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text">Upper Cut</div>
                    </div>
                    <input disabled ngModel="{{selectedEntity.upperCut}}" name="upperCut" type="number"
                           aria-describedby="upperCutHelp" class="form-control " placeholder="Upper Cut">
                  </div>
                </div>

                <div class="col-6">
                  <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text">Lower Cut</div>
                    </div>
                    <input disabled ngModel="{{selectedEntity.lowerCut}}" name="lowerCut" type="number"
                           aria-describedby="lowerCutHelp" class="form-control" placeholder="Lower Cut">
                  </div>
                </div>

              </div>

            </div>
          </div>
          <div *ngIf="!formReady" class="d-flex justify-content-center" style="height: 100%">
            <mat-spinner [diameter]="50" class="align-self-center"></mat-spinner>
          </div>

        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header py-1">
        <h5 class="modal-title m-0 ">Update the details of the selected {{selectedEntityType}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="" #putForm="ngForm">

          <div class="form-group height-transition" *ngIf="formReady">

            <label form="name"> Name</label>
            <input required ngModel="{{selectedEntity.name}}" name="name" type="text" class="form-control mb-2"
                   id="nameEdit" placeholder="Name">

            <label form="sequence"> Sequence</label>
            <input required ngModel="{{selectedEntity.sequence.value}}" name="sequence" type="text" class="form-control"
                   id="sequenceEdit" placeholder="Sequence">


            <div *ngIf="selectedEntityType == 'enzyme'" class="mt-2">

              <div class="form-row align-items-center">

                <div class="col-6">
                  <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text">Upper Cut</div>
                    </div>
                    <input required ngModel="{{selectedEntity.upperCut}}" name="upperCut" type="number"
                           aria-describedby="upperCutHelp" class="form-control " placeholder="Upper Cut">
                  </div>
                </div>

                <div class="col-6">
                  <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text">Lower Cut</div>
                    </div>
                    <input required ngModel="{{selectedEntity.lowerCut}}" name="lowerCut" type="number"
                           aria-describedby="lowerCutHelp" class="form-control" placeholder="Lower Cut">
                  </div>
                </div>

              </div>

            </div>


          </div>
          <div *ngIf="!formReady" class="d-flex justify-content-center" style="height: 100%">
            <mat-spinner [diameter]="50" class="align-self-center"></mat-spinner>
          </div>

        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button (click)="editEntity(putForm)" data-dismiss="modal" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
<div class="modal  fade" id="deleteModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header py-1">
        <button type="button" class="close " data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center">
        Are you sure you want to delete {{selectedEntity ? selectedEntity.name : ''}} ?
      </div>
      <div class="modal-footer row no-gutters py-0">
        <button type="button" class="btn btn-secondary mr-auto ml-4 col-3" data-dismiss="modal">NO</button>
        <button type="button" (click)="deleteEntity()" class="btn btn-danger col-3 mr-4" data-dismiss="modal">YES
        </button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="createModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header py-1">
        <h5 class="modal-title m-0">Create a new {{selectedEntityType}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="" #createForm="ngForm">
          <div class="form-group height-transition">

            <label form="name"> Name</label>
            <input required ngModel name="name" type="text" class="form-control mb-2" id="name" placeholder="Name">

            <label form="sequence"> Sequence</label>
            <input required ngModel name="sequence" type="text" class="form-control" id="sequence"
                   placeholder="Sequence">

            <div *ngIf="selectedEntityType == 'enzyme'" class="mt-2">

              <div class="form-row align-items-center">

                <div class="col-6">
                  <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text">Upper Cut</div>
                    </div>
                    <input required ngModel name="upperCut" type="number" aria-describedby="upperCutHelp"
                           class="form-control " placeholder="Upper Cut">
                  </div>
                </div>

                <div class="col-6">
                  <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text">Lower Cut</div>
                    </div>
                    <input required ngModel name="lowerCut" type="number" aria-describedby="lowerCutHelp"
                           class="form-control" placeholder="Lower Cut">
                  </div>
                </div>

              </div>

            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button (click)="createEntity(createForm)" data-dismiss="modal" class="btn btn-primary">Create</button>
      </div>
    </div>
  </div>
</div>
<!-- END OF MODALS -->

<div class="bg-white text-center">

  <nav class="navbar navbar-light bg-primary justify-content-between">

    <div>
      <button [ngClass]="selectedEntityType == 'dna' ? 'bg-mat-primary' : 'bg-white'"
              (click)="currentPage = 1; setEntityList('dna')"
              class="btn  mr-md-2 mr-1 " type="submit">DNA
      </button>
      <button [ngClass]="selectedEntityType == 'enzyme' ? 'bg-mat-primary' : 'bg-white'"
              (click)="currentPage = 1; setEntityList('enzyme'); " class="btn  mr-md-2 mr-1 " type="submit">ENZYMES
      </button>
      <button [ngClass]="selectedEntityType == 'gene' ? 'bg-mat-primary' : 'bg-white'"
              (click)="currentPage = 1; setEntityList('gene')"
              class="btn  " type="submit">GENES
      </button>
    </div>

    <div class="form-inline">
      <div class="input-group">
        <input style="border-right: 0" type="text" class="form-control" placeholder="Search"
               aria-describedby="button-addon2">
        <div class="input-group-append bg-white search-border">
          <mat-icon class="mt-2"> search</mat-icon>
        </div>
      </div>

      <mat-icon data-toggle="modal" data-target="#createModal" style="font-size: 2rem; cursor: pointer"
                class="text-success mb-2 ml-4"> add_box
      </mat-icon>

    </div>


  </nav>

  <table *ngIf="contentLoaded" class="table w-100">
    <thead class="thead-dark">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Name</th>
      <th class=""> &nbsp;
      </th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let entity of entityList; let i = index">
      <th scope="row" style="width: 25%" class="pt-4">{{i + 1}}</th>
      <td class="pt-4" style="font-size: 1.2rem; width: 50%">{{entity.name}}</td>
      <td style="width: 25%">
        <div style="float: right" class="pt-2">
          <mat-icon (click)="openEdit(entity); selectedEntityIndex = (currentPage - 1) * entitiesPerPage + i"
                    data-toggle="modal" data-target="#infoModal"
                    style="vertical-align: center" class="image-size text-primary">info
          </mat-icon>
          <mat-icon (click)="openEdit(entity); selectedEntityIndex = (currentPage - 1) * entitiesPerPage + i"
                    data-toggle="modal" data-target="#editModal"
                    style="vertical-align: center" color="accent" class="image-size">edit
          </mat-icon>
          <mat-icon (click)="selectedEntity = entity; selectedEntityIndex = (currentPage - 1) * entitiesPerPage + i"
                    data-toggle="modal"
                    data-target="#deleteModal"
                    style="vertical-align: center" color="warn" class="image-size">delete
          </mat-icon>
        </div>
      </td>
    </tr>
    </tbody>
    <tfoot>
    <tr>
      <td>&nbsp;</td>
      <th>
        <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center m-0">
            <li class="page-item">
              <a class="page-link" (click)="changePage(1)" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
                <span class="sr-only">Previous</span>
              </a>
            </li>

            <li *ngIf="currentPage == pageTotal && currentPage - 2 >= 1" class="page-item" (click)="changePage(currentPage - 2)"><a class="page-link">{{currentPage - 2}}</a></li>
            <li *ngIf="currentPage - 1 >= 1" class="page-item" (click)="changePage(currentPage - 1)"><a class="page-link">{{currentPage - 1}}</a></li>
            <li class="page-item" (click)="changePage(currentPage)"><a class="page-link bg-dark" style="color: white">{{currentPage}}</a></li>
            <li *ngIf="currentPage + 1 <=   pageTotal" class="page-item" (click)="changePage(currentPage + 1)"><a class="page-link">{{currentPage + 1}}</a></li>
            <li *ngIf="currentPage == 1 && currentPage + 2 <=   pageTotal" class="page-item" (click)="changePage(currentPage + 2)"><a class="page-link">{{currentPage + 2}}</a></li>

            <li class="page-item">
              <a class="page-link" (click)="changePage(pageTotal)" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
              </a>
            </li>
          </ul>
        </nav>
      </th>
      <td></td>
    </tr>
    </tfoot>
  </table>

</div>
